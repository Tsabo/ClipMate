<dx:ThemedWindow
    x:Class="ClipMate.App.ClassicWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
    xmlns:helpers="clr-namespace:ClipMate.App.Helpers"
    xmlns:local="clr-namespace:ClipMate.App"
    xmlns:vm="clr-namespace:ClipMate.App.ViewModels"
    xmlns:controls="clr-namespace:ClipMate.App.Controls"
    d:DataContext="{d:DesignInstance Type=vm:ClassicViewModel}"
    mc:Ignorable="d"
    Title="ClipMate"
    Width="700"
    Height="500"
    MinWidth="500"
    MinHeight="200"
    ResizeMode="CanResize"
    ShowInTaskbar="False"
    WindowStartupLocation="CenterScreen"
    Loaded="Window_Loaded"
    Closing="Window_Closing">

    <dx:ThemedWindow.InputBindings>
        <KeyBinding Key="Escape" Command="{Binding CloseWindowCommand}" />
        <KeyBinding Key="F2" Command="{Binding MainMenu.ViewClipCommand}" />
        <KeyBinding Key="F5" Command="{Binding MainMenu.SwitchToLastCollectionCommand}" />
        <KeyBinding Key="F6" Command="{Binding MainMenu.SwitchToFavoriteCollectionCommand}" />
        <KeyBinding Key="F7" Command="{Binding MainMenu.CheckSpellingCommand}" />
        <KeyBinding Key="F8" Command="{Binding MainMenu.SelectCollectionCommand}" />
        <KeyBinding Key="F12" Command="{Binding MainMenu.AutoCaptureCommand}" />
        <KeyBinding Key="N" Modifiers="Ctrl" Command="{Binding MainMenu.CreateNewClipCommand}" />
        <KeyBinding Key="R" Modifiers="Ctrl" Command="{Binding MainMenu.RenameClipCommand}" />
        <KeyBinding Key="P" Modifiers="Ctrl" Command="{Binding MainMenu.PrintCommand}" />
        <KeyBinding Key="O" Modifiers="Ctrl" Command="{Binding MainMenu.OpenSourceUrlCommand}" />
        <KeyBinding Key="F" Modifiers="Ctrl" Command="{Binding MainMenu.SearchCommand}" />
        <KeyBinding Key="E" Modifiers="Ctrl" Command="{Binding MainMenu.SwitchViewCommand}" />
        <KeyBinding Key="U" Modifiers="Ctrl" Command="{Binding MainMenu.PowerPasteUpCommand}" />
        <KeyBinding Key="D" Modifiers="Ctrl" Command="{Binding MainMenu.PowerPasteDownCommand}" />
        <KeyBinding Key="Enter" Modifiers="Alt" Command="{Binding MainMenu.ClipPropertiesCommand}" />
        <KeyBinding Key="R" Modifiers="Alt" Command="{Binding MainMenu.ReloadCollectionCommand}" />
        <KeyBinding Key="A" Modifiers="Ctrl+Alt" Command="{Binding MainMenu.AppendClipsCommand}" />
        <KeyBinding Key="B" Modifiers="Ctrl+Alt" Command="{Binding MainMenu.RemoveLineBreaksCommand}" />
        <KeyBinding Key="T" Modifiers="Ctrl+Alt" Command="{Binding MainMenu.StripNonTextCommand}" />
        <KeyBinding Key="P" Modifiers="Ctrl+Alt" Command="{Binding MainMenu.SelectPreviousCommand}" />
        <KeyBinding Key="N" Modifiers="Ctrl+Alt" Command="{Binding MainMenu.SelectNextCommand}" />
    </dx:ThemedWindow.InputBindings>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- BarManager: Menu and Toolbar -->
        <dxb:BarManager x:Name="BarManager" Grid.Row="0">
            <dxb:BarManager.Bars>
                <!-- Main Menu -->
                <dxb:Bar Caption="Main Menu" IsMainMenu="True">
                    <!-- File Menu -->
                    <dxb:BarSubItem Content="_File">
                        <dxb:BarButtonItem Content="Create New, Empty Clip" KeyGesture="Ctrl+N"
                                           Command="{Binding MainMenu.CreateNewClipCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ“„'}" />
                        <dxb:BarButtonItem Content="Clip Properties" KeyGesture="Alt+Enter"
                                           Command="{Binding MainMenu.ClipPropertiesCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ“‹'}" />
                        <dxb:BarButtonItem Content="Rename Clip" KeyGesture="Ctrl+R"
                                           Command="{Binding MainMenu.RenameClipCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='âœï¸'}" />
                        <dxb:BarButtonItem Content="Delete Selected Items"
                                           Command="{Binding MainMenu.DeleteSelectedCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ—‘ï¸'}" />
                        <dxb:BarButtonItem Content="Un Delete" Command="{Binding MainMenu.UnDeleteCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='â™»ï¸'}" />
                        <dxb:BarButtonItem Content="Copy Item To Collection"
                                           Command="{Binding MainMenu.CopyToCollectionCommand}"
                                           Glyph="{helpers:CustomFontIconSource Glyph={x:Static local:Icons.CopyToCollection}, Size=24}" />
                        <dxb:BarButtonItem Content="Move Item To Collection"
                                           Command="{Binding MainMenu.MoveToCollectionCommand}"
                                           Glyph="{helpers:CustomFontIconSource Glyph={x:Static local:Icons.MoveToCollection}}" />
                        <dxb:BarButtonItem Content="Export Clips (Save To Individual Files)"
                                           Command="{Binding MainMenu.ExportClipsCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ’¾'}" />
                        <dxb:BarButtonItem Content="Export Clip(s) to XML"
                                           Command="{Binding MainMenu.ExportToXmlCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ“¤'}" />
                        <dxb:BarButtonItem Content="Import Clip(s) from XML"
                                           Command="{Binding MainMenu.ImportFromXmlCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ“¥'}" />
                        <dxb:BarItemSeparator />
                        <dxb:BarButtonItem Content="Decrypt and remove encryption on selected clips"
                                           Command="{Binding MainMenu.DecryptClipsCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ”“'}" />
                        <dxb:BarButtonItem Content="Encrypt selected clips"
                                           Command="{Binding MainMenu.EncryptClipsCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ”’'}" />
                        <dxb:BarButtonItem Content="Forget Encryption Key"
                                           Command="{Binding MainMenu.ForgetEncryptionKeyCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ”‘'}" />
                        <dxb:BarItemSeparator />
                        <dxb:BarButtonItem Content="Properties" Command="{Binding MainMenu.ShowPropertiesCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='âš™ï¸'}" />
                        <dxb:BarButtonItem Content="Add New Collection"
                                           Command="{Binding MainMenu.AddCollectionCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ“'}" />
                        <dxb:BarButtonItem Content="Delete Collection"
                                           Command="{Binding MainMenu.DeleteCollectionCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ—‘ï¸'}" />
                        <dxb:BarButtonItem Content="Reload Collection" KeyGesture="Alt+R"
                                           Command="{Binding MainMenu.ReloadCollectionCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ”„'}" />
                        <dxb:BarButtonItem Content="Resequence Sort Keys"
                                           Command="{Binding MainMenu.ResequenceSortKeysCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ”¢'}" />
                        <dxb:BarItemSeparator />
                        <dxb:BarSubItem Content="Database Maintenance"
                                        Glyph="{helpers:EmojiIconSource Emoji='ðŸ—„ï¸'}">
                            <dxb:BarButtonItem Content="Backup Database..."
                                               Command="{Binding MainMenu.BackupDatabaseCommand}"
                                               Glyph="{helpers:EmojiIconSource Emoji='ðŸ’¾'}" />
                            <dxb:BarButtonItem Content="Restore Database..."
                                               Command="{Binding MainMenu.RestoreDatabaseCommand}"
                                               Glyph="{helpers:EmojiIconSource Emoji='ðŸ“¥'}" />
                            <dxb:BarItemSeparator />
                            <dxb:BarButtonItem Content="Empty Trash..." Command="{Binding MainMenu.EmptyTrashCommand}"
                                               Glyph="{helpers:EmojiIconSource Emoji='ðŸ—‘ï¸'}" />
                            <dxb:BarItemSeparator />
                            <dxb:BarButtonItem Content="Simple Repair (VACUUM)..."
                                               Command="{Binding MainMenu.SimpleRepairCommand}"
                                               Glyph="{helpers:EmojiIconSource Emoji='ðŸ› ï¸'}" />
                            <dxb:BarButtonItem Content="Comprehensive Repair..."
                                               Command="{Binding MainMenu.ComprehensiveRepairCommand}"
                                               Glyph="{helpers:EmojiIconSource Emoji='ðŸ”§'}" />
                            <dxb:BarItemSeparator />
                            <dxb:BarButtonItem Content="Run Cleanup Now..."
                                               Command="{Binding MainMenu.RunCleanupNowCommand}"
                                               Glyph="{helpers:EmojiIconSource Emoji='ðŸ§¹'}" />
                        </dxb:BarSubItem>
                        <dxb:BarButtonItem Content="Activate Database"
                                           Command="{Binding MainMenu.ActivateDatabaseCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='âœ…'}" />
                        <dxb:BarButtonItem Content="De-Activate Database"
                                           Command="{Binding MainMenu.DeactivateDatabaseCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='â›”'}" />
                        <dxb:BarItemSeparator />
                        <dxb:BarButtonItem Content="Print..." KeyGesture="Ctrl+P"
                                           Command="{Binding MainMenu.PrintCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ–¨ï¸'}" />
                        <dxb:BarButtonItem Content="Enable Quick Print"
                                           Command="{Binding MainMenu.EnableQuickPrintCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='âš¡'}" />
                        <dxb:BarButtonItem Content="Print Options..." Command="{Binding MainMenu.PrintOptionsCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='âš™ï¸'}" />
                        <dxb:BarItemSeparator />
                        <dxb:BarButtonItem Content="Exit Program (Shut Down)" Command="{Binding MainMenu.ExitCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸšª'}" />
                    </dxb:BarSubItem>

                    <!-- Edit Menu -->
                    <dxb:BarSubItem Content="_Edit">
                        <dxb:BarButtonItem Content="Undo" Command="{Binding MainMenu.UndoCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='â†©ï¸'}" />
                        <dxb:BarButtonItem Content="Select All Clips" Command="{Binding MainMenu.SelectAllCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='â˜‘ï¸'}" />
                        <dxb:BarItemSeparator />
                        <dxb:BarButtonItem Content="Capture Special..."
                                           Command="{Binding MainMenu.CaptureSpecialCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸŽ¯'}" />
                        <dxb:BarButtonItem Content="Append Clips Together (Glue)" KeyGesture="Ctrl+Alt+A"
                                           Command="{Binding MainMenu.AppendClipsCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ§‚'}" />
                        <dxb:BarSubItem Content="Screen Capture"
                                        Glyph="{helpers:EmojiIconSource Emoji='ðŸ“·'}" />
                        <dxb:BarSubItem Content="QuickPaste"
                                        Glyph="{helpers:EmojiIconSource Emoji='âš¡'}" />
                        <dxb:BarItemSeparator />
                        <dxb:BarSubItem Content="Case Conversion"
                                        Glyph="{helpers:EmojiIconSource Emoji='ðŸ”¤'}" />
                        <dxb:BarButtonItem Content="Clean-Up Text..." Command="{Binding MainMenu.CleanUpTextCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ§¹'}" />
                        <dxb:BarButtonItem Content="Shift Left" Command="{Binding MainMenu.ShiftLeftCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='â¬…ï¸'}" />
                        <dxb:BarButtonItem Content="Shift Right" Command="{Binding MainMenu.ShiftRightCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='âž¡ï¸'}" />
                        <dxb:BarButtonItem Content="Remove Linebreaks" KeyGesture="Ctrl+Alt+B"
                                           Command="{Binding MainMenu.RemoveLineBreaksCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ”—'}" />
                        <dxb:BarButtonItem Content="Check Spelling" KeyGesture="F7"
                                           Command="{Binding MainMenu.CheckSpellingCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ“'}" />
                        <dxb:BarButtonItem Content="Change Title and Shortcut" KeyGesture="Ctrl+R"
                                           Command="{Binding MainMenu.ChangeTitleCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ·ï¸'}" />
                        <dxb:BarButtonItem Content="Strip Out Non-TEXT Data Formats" KeyGesture="Ctrl+Alt+T"
                                           Command="{Binding MainMenu.StripNonTextCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='âœ‚ï¸'}" />
                        <dxb:BarButtonItem Content="Convert File Pointer To Text"
                                           Command="{Binding MainMenu.ConvertFilePointerCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ“„'}" />
                        <dxb:BarButtonItem Content="Unicode To Ansi" Command="{Binding MainMenu.UnicodeToAnsiCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸŒ'}" />
                        <dxb:BarItemSeparator />
                        <dxb:BarButtonItem Content="PowerPaste Up" KeyGesture="Ctrl+U"
                                           Command="{Binding MainMenu.PowerPasteUpCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='â¬†ï¸'}" />
                        <dxb:BarButtonItem Content="PowerPaste Down" KeyGesture="Ctrl+D"
                                           Command="{Binding MainMenu.PowerPasteDownCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='â¬‡ï¸'}" />
                        <dxb:BarCheckItem Content="PowerPaste Option - Loop" IsChecked="{Binding MainMenu.IsLoopMode}"
                                          Glyph="{helpers:EmojiIconSource Emoji='ðŸ”'}" />
                        <dxb:BarCheckItem Content="PowerPaste Option - Explode Into Fragments"
                                          IsChecked="{Binding MainMenu.IsExplodeMode}"
                                          Glyph="{helpers:EmojiIconSource Emoji='ðŸ’¥'}" />
                    </dxb:BarSubItem>

                    <!-- Tools Menu -->
                    <dxb:BarSubItem Content="_Tools">
                        <dxb:BarCheckItem Content="Auto Capture" KeyGesture="F12"
                                          IsChecked="{Binding MainMenu.IsAutoCapturing, Mode=OneWay}"
                                          Command="{Binding MainMenu.AutoCaptureCommand}"
                                          Glyph="{helpers:EmojiIconSource Emoji='ðŸ“¹'}" />
                        <dxb:BarCheckItem Content="Filter Outbound Clips"
                                          IsChecked="{Binding MainMenu.IsOutboundFilterEnabled}"
                                          Glyph="{helpers:EmojiIconSource Emoji='ðŸ“Š'}" />
                        <dxb:BarItemSeparator />
                        <dxb:BarButtonItem Content="Options..." Command="{Binding MainMenu.OptionsCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='âš™ï¸'}" />
                        <dxb:BarButtonItem Content="Application Profile..."
                                           Command="{Binding MainMenu.AppProfileCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ’»'}" />
                        <dxb:BarButtonItem Content="Language" Command="{Binding MainMenu.LanguageCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸŒ'}" />
                        <dxb:BarItemSeparator />
                        <dxb:BarButtonItem Content="Clipboard Diagnostics..."
                                           Command="{Binding MainMenu.ClipboardDiagnosticsCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ©º'}" />
                        <dxb:BarButtonItem Content="Trace Paste" Command="{Binding MainMenu.TracePasteCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ‘£'}" />
                        <dxb:BarButtonItem Content="Re-Establish Clipboard Connection"
                                           Command="{Binding MainMenu.ReestablishClipboardCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ”„'}" />
                        <dxb:BarItemSeparator />
                        <!-- SQL Window: Simple button when single database -->
                        <dxb:BarButtonItem Content="Show SQL Window"
                                           Command="{Binding MainMenu.ShowSqlWindowCommand}"
                                           IsVisible="{Binding MainMenu.HasMultipleDatabases, Converter={StaticResource InverseBoolConverter}}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ–³ï¸'}" />
                        <!-- SQL Window: Submenu when multiple databases -->
                        <dxb:BarSubItem x:Name="ShowSqlWindowMultiple"
                                        Content="Show SQL Window"
                                        IsVisible="{Binding MainMenu.HasMultipleDatabases}"
                                        GetItemData="SqlWindowDropdown_GetItemData"
                                        Glyph="{helpers:EmojiIconSource Emoji='ðŸ–³ï¸'}" />
                        <dxb:BarButtonItem Content="Show Event Log" Command="{Binding MainMenu.ShowEventLogCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ“œ'}" />
                    </dxb:BarSubItem>

                    <!-- View Menu -->
                    <dxb:BarSubItem Content="_View">
                        <dxb:BarButtonItem Content="Find (Search)..." KeyGesture="Ctrl+F"
                                           Command="{Binding MainMenu.SearchCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ”'}" />
                        <dxb:BarButtonItem Content="Select Previous Item (Up)" KeyGesture="Ctrl+Alt+P"
                                           Command="{Binding MainMenu.SelectPreviousCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='â¬†ï¸'}" />
                        <dxb:BarButtonItem Content="Select Next Item (Down)" KeyGesture="Ctrl+Alt+N"
                                           Command="{Binding MainMenu.SelectNextCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='â¬‡ï¸'}" />
                        <dxb:BarItemSeparator />
                        <dxb:BarButtonItem Content="Switch To Last Collection" KeyGesture="F5"
                                           Command="{Binding MainMenu.SwitchToLastCollectionCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ”™'}" />
                        <dxb:BarButtonItem Content="Switch to Favorite Collection" KeyGesture="F6"
                                           Command="{Binding MainMenu.SwitchToFavoriteCollectionCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='â­'}" />
                        <dxb:BarButtonItem Content="Select Collection" KeyGesture="F8"
                                           Command="{Binding MainMenu.SelectCollectionCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ“‚'}" />
                        <dxb:BarItemSeparator />
                        <dxb:BarButtonItem Content="Open Source URL In Browser" KeyGesture="Ctrl+O"
                                           Command="{Binding MainMenu.OpenSourceUrlCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸŒ'}" />
                        <dxb:BarButtonItem Content="CharMap (Launch)" Command="{Binding MainMenu.LaunchCharMapCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ”¤'}" />
                        <dxb:BarItemSeparator />
                        <dxb:BarButtonItem Content="View Clip" KeyGesture="F2"
                                           Command="{Binding MainMenu.ViewClipCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ‘ï¸'}" />
                        <dxb:BarButtonItem Content="Switch Between Classic / Explorer" KeyGesture="Ctrl+E"
                                           Command="{Binding MainMenu.SwitchViewCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ”€'}" />
                        <dxb:BarButtonItem Content="Open ClipMate Explorer"
                                           Command="{Binding MainMenu.OpenExplorerCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ“‚'}" />
                        <dxb:BarButtonItem Content="Open ClipMate Classic"
                                           Command="{Binding MainMenu.OpenClassicCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ“ƒ'}" />
                        <dxb:BarButtonItem Content="Close And Free All Windows"
                                           Command="{Binding MainMenu.CloseAllWindowsCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='âŒ'}" />
                        <dxb:BarItemSeparator />
                        <dxb:BarSubItem Content="Visibility"
                                        Glyph="{helpers:EmojiIconSource Emoji='ðŸ‘ï¸'}" />
                        <dxb:BarSubItem Content="Classic Options"
                                        Glyph="{helpers:EmojiIconSource Emoji='ðŸ“'}" />
                        <dxb:BarButtonItem Content="Transparency" Command="{Binding MainMenu.TransparencyCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ’«'}" />
                    </dxb:BarSubItem>

                    <!-- Help Menu -->
                    <dxb:BarSubItem Content="_Help">
                        <dxb:BarButtonItem Content="About ClipMate" Command="{Binding MainMenu.AboutCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='â„¹ï¸'}" />
                        <dxb:BarItemSeparator />
                        <dxb:BarButtonItem Content="Documentation (GitHub Wiki)"
                                           Command="{Binding MainMenu.DocumentationCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ“–'}" />
                        <dxb:BarButtonItem Content="View on GitHub" Command="{Binding MainMenu.ViewOnGitHubCommand}"
                                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ™'}" />
                    </dxb:BarSubItem>
                </dxb:Bar>

                <!-- Toolbar -->
                <dxb:Bar Caption="Main Toolbar" IsMainMenu="False" AllowCollapse="True">
                    <dxb:BarButtonItem Content="PowerPaste"
                                       Command="{Binding MainMenu.PowerPasteToggleCommand}"
                                       ToolTip="Toggle PowerPaste"
                                       Glyph="{dx:DXImage 'SvgImages/Actions/Forward.svg'}" />
                    <dxb:BarButtonItem Content="Delete"
                                       Command="{Binding MainMenu.DeleteSelectedCommand}"
                                       ToolTip="Delete selected clip(s)"
                                       Glyph="{helpers:CustomFontIconSource Glyph={x:Static local:Icons.Delete}, Size=24}" />
                    <dxb:BarButtonItem Content="Print"
                                       Command="{Binding MainMenu.PrintCommand}"
                                       ToolTip="Print selected clip(s)"
                                       Glyph="{dx:DXImage 'SvgImages/Print/Print.svg'}" />
                    <dxb:BarButtonItem Content="Append"
                                       Command="{Binding MainMenu.AppendClipsCommand}"
                                       ToolTip="Append selected clips together"
                                       Glyph="{helpers:CustomFontIconSource Glyph={x:Static local:Icons.Append}, Size=24}" />
                    <dxb:BarButtonItem Content="Remove Breaks"
                                       Command="{Binding MainMenu.RemoveLineBreaksCommand}"
                                       ToolTip="Remove line breaks"
                                       Glyph="{helpers:EmojiIconSource Emoji='ðŸ”—'}" />
                    <dxb:BarSubItem x:Name="MoveToCollectionDropdown"
                                    Content="Move to Collection"
                                    ToolTip="Move selected clip(s) to a collection"
                                    Glyph="{helpers:CustomFontIconSource Glyph={x:Static local:Icons.MoveToCollection}, Size=24}"
                                    GetItemData="MoveToCollectionDropdown_GetItemData" />
                    <dxb:BarSubItem x:Name="CopyToCollectionDropdown"
                                    Content="Copy to Collection"
                                    ToolTip="Copy selected clip(s) to a collection"
                                    Glyph="{helpers:CustomFontIconSource Glyph={x:Static local:Icons.CopyToCollection}, Size=24}"
                                    GetItemData="CopyToCollectionDropdown_GetItemData" />

                    <!-- Search Button -->
                    <dxb:BarButtonItem Content="Search"
                                       Command="{Binding MainMenu.SearchCommand}"
                                       ToolTip="Search clips (Ctrl+F)"
                                       Glyph="{helpers:EmojiIconSource Emoji='ðŸ”'}" />

                    <!-- Switch View Button -->
                    <dxb:BarButtonItem Content="Switch View"
                                       Command="{Binding MainMenu.SwitchViewCommand}"
                                       ToolTip="Switch between Classic and Explorer"
                                       Glyph="{helpers:EmojiIconSource Emoji='ðŸ”€'}" />

                    <!-- View Clip Button -->
                    <dxb:BarButtonItem Content="View Clip"
                                       Command="{Binding MainMenu.ViewClipCommand}"
                                       ToolTip="View selected clip in floating window (F2)"
                                       Glyph="{helpers:EmojiIconSource Emoji='ðŸ‘ï¸'}" />

                    <!-- Outbound Filtering Toggle -->
                    <dxb:BarCheckItem Content="Outbound Filtering"
                                      IsChecked="{Binding MainMenu.IsOutboundFilterEnabled}"
                                      ToolTip="Enable/disable outbound clip filtering"
                                      Glyph="{helpers:EmojiIconSource Emoji='ðŸ“Š'}" />
                    <dxb:BarSubItem x:Name="TemplateDropdown"
                                    Content="Templates"
                                    ToolTip="Select a template for clip merging"
                                    Glyph="{helpers:EmojiIconSource Emoji='ðŸ“„'}"
                                    GetItemData="TemplateDropdown_GetItemData" />
                    <dxb:BarButtonItem Content="Text Clean-up"
                                       Command="{Binding MainMenu.CleanUpTextCommand}"
                                       ToolTip="Clean up text formatting"
                                       Glyph="{helpers:EmojiIconSource Emoji='ðŸ§¹'}" />
                    <dxb:BarCheckItem Content="Loop PowerPaste"
                                      IsChecked="{Binding MainMenu.IsLoopMode}"
                                      ToolTip="Enable PowerPaste looping mode"
                                      Glyph="{helpers:EmojiIconSource Emoji='ðŸ”'}" />
                    <dxb:BarCheckItem Content="Explode PowerPaste"
                                      IsChecked="{Binding MainMenu.IsExplodeMode}"
                                      ToolTip="Enable PowerPaste explode mode"
                                      Glyph="{helpers:EmojiIconSource Emoji='ðŸ’¥'}" />
                    <dxb:BarButtonItem Content="Event Log"
                                       Command="{Binding MainMenu.ShowEventLogCommand}"
                                       ToolTip="Show event log window"
                                       Glyph="{helpers:EmojiIconSource Emoji='ðŸ“œ'}" />
                </dxb:Bar>
            </dxb:BarManager.Bars>
        </dxb:BarManager>

        <Grid Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <controls:ClipListControl Grid.Row="0"
                                      DataContext="{Binding ClipListViewModel}"
                                      Items="{Binding Clips}"
                                      SelectedItem="{Binding SelectedClip}"
                                      SelectedItems="{Binding SelectedClips, Mode=TwoWay}" />

            <controls:QuickPasteToolbar Grid.Row="1"
                                        DataContext="{Binding QuickPasteToolbarViewModel}" />
        </Grid>
    </Grid>
</dx:ThemedWindow>
