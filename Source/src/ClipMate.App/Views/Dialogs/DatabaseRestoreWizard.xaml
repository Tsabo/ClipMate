<dx:ThemedWindow x:Class="ClipMate.App.Views.Dialogs.DatabaseRestoreWizard"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
                 xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
                 xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
                 Title="ClipMate Database Restore Wizard"
                 Width="600"
                 Height="500"
                 WindowStartupLocation="CenterOwner"
                 ResizeMode="NoResize"
                 ShowInTaskbar="False">

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0"
                BorderThickness="0,0,0,1"
                Padding="0,0,0,15"
                Margin="0,0,0,15">
            <TextBlock Text="Restore Database from Backup"
                       FontSize="16"
                       FontWeight="SemiBold" />
        </Border>

        <!-- Page Content -->
        <ScrollViewer Grid.Row="1"
                      VerticalScrollBarVisibility="Auto">
            <Grid>
                <!-- Welcome Page -->
                <dxlc:LayoutControl Orientation="Vertical"
                                    Visibility="{Binding IsWelcomePage, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <TextBlock TextWrapping="Wrap"
                               Margin="0,0,0,15">
                        <Run Text="Welcome to the ClipMate Database Restore Wizard" FontWeight="SemiBold" FontSize="14" />
                        <LineBreak /><LineBreak />
                        <Run Text="This wizard will help you restore your database from a previously created backup." />
                        <LineBreak /><LineBreak />
                        <Run Text="Database to restore:" FontWeight="SemiBold" />
                        <Run Text="{Binding DatabaseName, Mode=OneTime}" />
                        <LineBreak /><LineBreak />
                        <Run Text="⚠️ Warning:" FontWeight="Bold" Foreground="OrangeRed" />
                        <Run
                            Text="Restoring a database will replace all existing data in the current database with the data from the backup file. This operation cannot be undone."
                            Foreground="OrangeRed" />
                        <LineBreak /><LineBreak />
                        <Run Text="Before proceeding:" FontWeight="SemiBold" />
                        <LineBreak />
                        <Run Text="1. Ensure you have a valid backup ZIP file" />
                        <LineBreak />
                        <Run Text="2. Close any other applications that might be accessing the database" />
                        <LineBreak />
                        <Run Text="3. Consider creating a backup of your current database first" />
                        <LineBreak /><LineBreak />
                        <Run Text="Click 'Next' to continue." />
                    </TextBlock>
                </dxlc:LayoutControl>

                <!-- Confirmation Page -->
                <dxlc:LayoutControl Orientation="Vertical"
                                    Visibility="{Binding IsConfirmationPage, Converter={StaticResource BooleanToVisibilityConverter}}"
                                    ItemSpace="15">
                    <TextBlock TextWrapping="Wrap"
                               Margin="0,0,0,10">
                        <Run Text="Select Backup File" FontWeight="SemiBold" FontSize="14" />
                        <LineBreak /><LineBreak />
                        <Run Text="Please select the backup ZIP file you want to restore from." />
                    </TextBlock>

                    <dxlc:LayoutGroup Header="Backup File Selection"
                                      View="GroupBox"
                                      Orientation="Vertical">
                        <dxlc:LayoutItem Label="Backup ZIP File:">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <dxe:TextEdit Grid.Column="0"
                                              Text="{Binding BackupZipPath, UpdateSourceTrigger=PropertyChanged}"
                                              ToolTip="Path to the backup ZIP file" />
                                <Button Grid.Column="1"
                                        Content="Browse..."
                                        Click="BrowseBackupButton_Click"
                                        Padding="10,5"
                                        Margin="5,0,0,0" />
                            </Grid>
                        </dxlc:LayoutItem>
                    </dxlc:LayoutGroup>

                    <TextBlock TextWrapping="Wrap"
                               Foreground="Gray">
                        <Run Text="Review your selection:" FontWeight="SemiBold" />
                        <LineBreak /><LineBreak />
                        <Run Text="Database:" />
                        <Run Text="{Binding DatabaseName, Mode=OneTime}" FontWeight="SemiBold" />
                        <LineBreak />
                        <Run Text="Backup File:" />
                        <Run Text="{Binding BackupZipPath}" FontWeight="SemiBold" />
                        <LineBreak /><LineBreak />
                        <Run Text="Click 'Finish' to begin the restore process." />
                    </TextBlock>
                </dxlc:LayoutControl>

                <!-- Completion Page -->
                <dxlc:LayoutControl Orientation="Vertical"
                                    Visibility="{Binding IsCompletionPage, Converter={StaticResource BooleanToVisibilityConverter}}"
                                    ItemSpace="15">
                    <TextBlock Text="Restore Progress"
                               FontWeight="SemiBold"
                               FontSize="14"
                               Margin="0,0,0,10" />

                    <Border BorderThickness="1"
                            Padding="15"
                            MinHeight="200">
                        <StackPanel>
                            <dx:WaitIndicator DeferedVisibility="{Binding IsRestoring}"
                                              Margin="0,0,0,15"
                                              HorizontalAlignment="Center" />

                            <TextBlock Text="{Binding ProgressMessage}"
                                       TextWrapping="Wrap"
                                       FontFamily="Consolas"
                                       FontSize="11" />
                        </StackPanel>
                    </Border>

                    <TextBlock TextWrapping="Wrap"
                               Foreground="Gray"
                               Visibility="{Binding IsRestoring, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=Inverse}">
                        <Run Text="Restore operation completed." FontWeight="SemiBold" />
                        <LineBreak /><LineBreak />
                        <Run Text="Click 'Close' to exit the wizard." />
                    </TextBlock>
                </dxlc:LayoutControl>
            </Grid>
        </ScrollViewer>

        <!-- Navigation Buttons -->
        <Border Grid.Row="2"
                BorderThickness="0,1,0,0"
                Padding="0,15,0,0"
                Margin="0,15,0,0">
            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Right">
                <Button Content="&lt; Back"
                        Click="BackButton_Click"
                        IsEnabled="{Binding CanGoBack}"
                        Padding="15,5"
                        MinWidth="80"
                        Margin="0,0,10,0" />
                <Button Content="Next &gt;"
                        Click="NextButton_Click"
                        IsEnabled="{Binding CanGoNext}"
                        Padding="15,5"
                        MinWidth="80"
                        Margin="0,0,10,0" />
                <Button Content="Finish"
                        Click="FinishButton_Click"
                        Visibility="{Binding ShowFinish, Converter={StaticResource BooleanToVisibilityConverter}}"
                        Padding="15,5"
                        MinWidth="80"
                        Margin="0,0,10,0"
                        IsDefault="True" />
                <Button Content="Cancel"
                        Click="CancelButton_Click"
                        Visibility="{Binding IsCompletionPage, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=Inverse}"
                        Padding="15,5"
                        MinWidth="80"
                        IsCancel="True" />
                <Button Content="Close"
                        Click="CloseButton_Click"
                        Visibility="{Binding IsCompletionPage, Converter={StaticResource BooleanToVisibilityConverter}}"
                        Padding="15,5"
                        MinWidth="80"
                        IsCancel="True" />
            </StackPanel>
        </Border>
    </Grid>

</dx:ThemedWindow>
