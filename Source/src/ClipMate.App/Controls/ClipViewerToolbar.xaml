<UserControl x:Class="ClipMate.App.Controls.ClipViewerToolbar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:vm="clr-namespace:ClipMate.App.ViewModels"
             xmlns:helpers="clr-namespace:ClipMate.App.Helpers"
             xmlns:local="clr-namespace:ClipMate.App"
             d:DataContext="{d:DesignInstance Type=vm:ClipViewerToolbarViewModel}"
             mc:Ignorable="d">

    <dxb:ToolBarControl AllowQuickCustomization="False"
                        AllowCustomizationMenu="False"
                        UseWholeRow="True"
                        AllowCollapse="False">

        <!-- View Group -->
        <dxb:BarButtonItem Command="{Binding ToggleTackCommand}"
                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ“Œ'}"
                           ToolTip="Tack Viewer: Keep viewer open and allow drag-drop from clip list" />

        <dxb:BarButtonItem Command="{Binding ToggleWordWrapCommand}"
                           Glyph="{helpers:EmojiIconSource Emoji='â†”ï¸'}"
                           ToolTip="Toggle Word Wrap" />

        <dxb:BarButtonItem Command="{Binding ToggleShowNonPrintingCommand}"
                           Glyph="{helpers:EmojiIconSource Emoji='Â¶'}"
                           ToolTip="Show Non-Printing Characters" />

        <dxb:BarItemSeparator />

        <!-- Clipboard Group -->
        <dxb:BarButtonItem Content="New"
                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ“„'}"
                           Command="{Binding NewClipCommand}"
                           ToolTip="Create new empty clip" />

        <dxb:BarButtonItem Content="Cut"
                           Glyph="{helpers:CustomFontIconSource Glyph={x:Static local:Icons.Cut}}"
                           Command="{Binding CutCommand}"
                           ToolTip="Cut selected text to clipboard" />

        <dxb:BarButtonItem Content="Copy"
                           Glyph="{helpers:CustomFontIconSource Glyph={x:Static local:Icons.Copy}}"
                           Command="{Binding CopyCommand}"
                           ToolTip="Copy selected text to clipboard" />

        <dxb:BarButtonItem Content="Paste"
                           Glyph="{helpers:CustomFontIconSource Glyph={x:Static local:Icons.Paste}}"
                           Command="{Binding PasteCommand}"
                           ToolTip="Paste from clipboard" />

        <dxb:BarItemSeparator />

        <!-- Transform Group -->
        <dxb:BarSubItem Content="Transform"
                        Glyph="{helpers:EmojiIconSource Emoji='ðŸ”§'}">

            <!-- Remove Line Breaks submenu -->
            <dxb:BarSubItem Content="Remove Line Breaks"
                            Glyph="{helpers:EmojiIconSource Emoji='ðŸ”—'}">
                <dxb:BarButtonItem Content="Preserve Paragraphs"
                                   Command="{Binding RemoveLineBreaksCommand}"
                                   CommandParameter="PreserveParagraphs"
                                   ToolTip="Remove line breaks but preserve paragraph breaks (double line breaks)" />
                <dxb:BarButtonItem Content="Remove All"
                                   Command="{Binding RemoveLineBreaksCommand}"
                                   CommandParameter="RemoveAll"
                                   ToolTip="Remove all line breaks, joining all text into one line" />
                <dxb:BarButtonItem Content="URL Crunch"
                                   Command="{Binding RemoveLineBreaksCommand}"
                                   CommandParameter="UrlCrunch"
                                   ToolTip="Remove line breaks that interrupt URLs" />
            </dxb:BarSubItem>

            <!-- Case Conversion submenu -->
            <dxb:BarSubItem Content="Case Conversion"
                            Glyph="{helpers:EmojiIconSource Emoji='ðŸ”¤'}">
                <dxb:BarButtonItem Content="UPPERCASE"
                                   Command="{Binding ConvertCaseCommand}"
                                   CommandParameter="Uppercase"
                                   ToolTip="Convert text to UPPERCASE" />
                <dxb:BarButtonItem Content="lowercase"
                                   Command="{Binding ConvertCaseCommand}"
                                   CommandParameter="Lowercase"
                                   ToolTip="Convert text to lowercase" />
                <dxb:BarButtonItem Content="Title Case"
                                   Command="{Binding ConvertCaseCommand}"
                                   CommandParameter="TitleCase"
                                   ToolTip="Convert Text To Title Case" />
                <dxb:BarButtonItem Content="Sentence case"
                                   Command="{Binding ConvertCaseCommand}"
                                   CommandParameter="SentenceCase"
                                   ToolTip="Convert text to sentence case. first letter capitalized." />
                <dxb:BarButtonItem Content="iNVERT cASE"
                                   Command="{Binding ConvertCaseCommand}"
                                   CommandParameter="InvertCase"
                                   ToolTip="Invert the case of each character" />
            </dxb:BarSubItem>

            <dxb:BarItemSeparator />

            <dxb:BarButtonItem Content="Trim"
                               Glyph="{helpers:EmojiIconSource Emoji='âœ‚ï¸'}"
                               Command="{Binding TrimCommand}"
                               ToolTip="Remove leading and trailing whitespace from each line" />

            <dxb:BarButtonItem Content="Text Cleanup..."
                               Glyph="{helpers:EmojiIconSource Emoji='ðŸ§¹'}"
                               Command="{Binding OpenTextCleanupDialogCommand}"
                               ToolTip="Open Text Cleanup dialog for advanced text transformations" />
        </dxb:BarSubItem>

        <dxb:BarItemSeparator />

        <!-- Edit Group -->
        <dxb:BarButtonItem Content="Undo"
                           Glyph="{helpers:EmojiIconSource Emoji='â†©ï¸'}"
                           Command="{Binding UndoCommand}"
                           ToolTip="Undo last edit (Ctrl+Z)" />

        <dxb:BarButtonItem Content="Find"
                           Glyph="{helpers:EmojiIconSource Emoji='ðŸ”'}"
                           Command="{Binding FindCommand}"
                           ToolTip="Find and Replace (Ctrl+F)" />

        <dxb:BarItemSeparator />

        <!-- Help -->
        <dxb:BarButtonItem Content="Help"
                           Glyph="{helpers:EmojiIconSource Emoji='â“'}"
                           Command="{Binding ShowHelpCommand}"
                           ToolTip="Show ClipViewer help" />

        <dxb:BarItemSeparator />

        <!-- Language Selector -->
        <dxb:BarStaticItem Content="Language:" />
        <dxb:BarEditItem EditWidth="120"
                         ToolTip="Select syntax highlighting language">
            <dxb:BarEditItem.EditSettings>
                <dxe:ComboBoxEditSettings ItemsSource="{Binding AvailableLanguages}"
                                          IsTextEditable="False" />
            </dxb:BarEditItem.EditSettings>
            <dxb:BarEditItem.EditValue>
                <Binding Path="SelectedLanguage" Mode="TwoWay" />
            </dxb:BarEditItem.EditValue>
        </dxb:BarEditItem>

    </dxb:ToolBarControl>
</UserControl>
